<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Imported 3D Model with Scroll Animations</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #0f0f1a;
            color: #ffffff;
            overflow-x: hidden;
        }

        .section {
            height: 100vh;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            position: relative;
        }

        .section-content {
            max-width: 800px;
            text-align: center;
            z-index: 10;
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0;
        }

        h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            opacity: 0;
        }

        p {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 1rem;
            opacity: 0;
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 1;
        }

        #loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0f0f1a;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            flex-direction: column;
        }

        .loader {
            width: 48px;
            height: 48px;
            border: 5px solid #fff;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
            margin-bottom: 1rem;
        }

        .loading-text {
            color: #fff;
            font-size: 1rem;
        }

        @keyframes rotation {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>
    <div id="loading">
        <span class="loader"></span>
        <div class="loading-text">Preparing 3D Scene...</div>
    </div>

    <div id="canvas-container"></div>

    <section class="section" id="section1">
        <div class="section-content">
            <h1>Interactive 3D Model Experience</h1>
            <p>Scroll down to explore the 3D model with dynamic animations</p>
        </div>
    </section>

    <section class="section" id="section2">
        <div class="section-content">
            <h2>Rotate the Model</h2>
            <p>As you scroll, watch how the 3D model rotates and transforms</p>
        </div>
    </section>

    <section class="section" id="section3">
        <div class="section-content">
            <h2>Change Perspective</h2>
            <p>The camera angle shifts to give you a new view of the model</p>
        </div>
    </section>

    <section class="section" id="section4">
        <div class="section-content">
            <h2>Material Transformation</h2>
            <p>Watch the model materials change as you continue scrolling</p>
        </div>
    </section>

    <section class="section" id="section5">
        <div class="section-content">
            <h2>Final View</h2>
            <p>Explore the complete model with all transformations applied</p>
            <p>Try scrolling back up to see the animations in reverse!</p>
        </div>
    </section>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/ScrollTrigger.min.js"></script>

    <script>
        // Register ScrollTrigger plugin
        gsap.registerPlugin(ScrollTrigger);

        // Initialize Three.js scene
        let camera, scene, renderer, model, clock, mixer;
        let loadingTimeout;
        const container = document.getElementById('canvas-container');
        const loadingElement = document.getElementById('loading');
        const loadingText = document.querySelector('.loading-text');

        function init() {
            // Create scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0f0f1a);

            // Create camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;

            // Create renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            container.appendChild(renderer.domElement);

            // Create lights
            const ambientLight = new THREE.AmbientLight(0x404040, 1);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(1, 1, 1);
            directionalLight.castShadow = true;
            scene.add(directionalLight);

            // Add hemisphere light for better ambient lighting
            const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444, 0.6);
            hemiLight.position.set(0, 300, 0);
            scene.add(hemiLight);

            // Initialize clock for animations
            clock = new THREE.Clock();

            // Set a timeout for model loading to prevent infinite loading
            loadingTimeout = setTimeout(() => {
                loadingText.textContent = "Using fallback model due to loading timeout";
                createFallbackModel();
            }, 5000); // 5 seconds timeout

            // Try to load the model
            tryLoadModel();

            // Set up window resize handler
            window.addEventListener('resize', onWindowResize);

            // Start animation loop
            animate();
        }

        function tryLoadModel() {
            // Create a custom model - no external loading required
            createCustomModel();
        }

        function createCustomModel() {
            // Create a more complex model using Three.js geometries
            model = new THREE.Group();

            // Base platform
            const baseGeometry = new THREE.CylinderGeometry(2, 2, 0.3, 32);
            const baseMaterial = new THREE.MeshStandardMaterial({ color: 0x333333 });
            const base = new THREE.Mesh(baseGeometry, baseMaterial);
            base.position.y = -2;
            base.receiveShadow = true;
            model.add(base);

            // Main structure body
            const bodyGeometry = new THREE.BoxGeometry(1.5, 2, 1.5);
            const bodyMaterial = new THREE.MeshStandardMaterial({ color: 0x6495ED });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            body.position.y = -0.5;
            body.castShadow = true;
            body.receiveShadow = true;
            model.add(body);

            // Top part - dome
            const domeGeometry = new THREE.SphereGeometry(1, 32, 32, 0, Math.PI * 2, 0, Math.PI / 2);
            const domeMaterial = new THREE.MeshStandardMaterial({ color: 0xFF6347 });
            const dome = new THREE.Mesh(domeGeometry, domeMaterial);
            dome.position.y = 0.5;
            dome.castShadow = true;
            dome.receiveShadow = true;
            model.add(dome);

            // Decorative rings
            for (let i = 0; i < 3; i++) {
                const ringGeometry = new THREE.TorusGeometry(1.2 + (i * 0.2), 0.05, 16, 100);
                const ringMaterial = new THREE.MeshStandardMaterial({ color: 0x7CFC00 });
                const ring = new THREE.Mesh(ringGeometry, ringMaterial);
                ring.position.y = 0.5 + (i * 0.3);
                ring.rotation.x = Math.PI / 2;
                ring.castShadow = true;
                model.add(ring);
            }

            // Antennas
            for (let i = 0; i < 3; i++) {
                const antennaGeometry = new THREE.CylinderGeometry(0.05, 0.05, 1.5, 8);
                const antennaMaterial = new THREE.MeshStandardMaterial({ color: 0xFFD700 });
                const antenna = new THREE.Mesh(antennaGeometry, antennaMaterial);

                // Position in a triangle pattern on top
                const angle = (i * Math.PI * 2) / 3;
                antenna.position.x = Math.cos(angle) * 0.5;
                antenna.position.z = Math.sin(angle) * 0.5;
                antenna.position.y = 1.5;
                antenna.castShadow = true;

                model.add(antenna);
            }

            // Add model to scene
            scene.add(model);

            // Model is ready, clear timeout and setup animations
            clearTimeout(loadingTimeout);
            loadingElement.style.display = 'none';

            // Set up scroll animations
            setupScrollAnimations();
        }

        function createFallbackModel() {
            // Clear any existing timeout
            clearTimeout(loadingTimeout);

            // Create a simple fallback model
            const geometry = new THREE.BoxGeometry(2, 2, 2);
            const material = new THREE.MeshStandardMaterial({ color: 0x6495ED });
            model = new THREE.Mesh(geometry, material);
            model.castShadow = true;
            model.receiveShadow = true;
            scene.add(model);

            // Add a ground plane
            const planeGeometry = new THREE.PlaneGeometry(10, 10);
            const planeMaterial = new THREE.MeshStandardMaterial({ color: 0x333333 });
            const plane = new THREE.Mesh(planeGeometry, planeMaterial);
            plane.rotation.x = -Math.PI / 2;
            plane.position.y = -2;
            plane.receiveShadow = true;
            scene.add(plane);

            // Hide loading screen
            loadingElement.style.display = 'none';

            // Set up scroll animations
            setupScrollAnimations();
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);

            // Update animation mixer if it exists
            if (mixer) {
                mixer.update(clock.getDelta());
            }

            // Add some gentle rotation to the model when not being controlled by scroll
            if (model && !ScrollTrigger.isScrolling) {
                model.rotation.y += 0.003;
            }

            renderer.render(scene, camera);
        }

        // Set up GSAP scroll animations
        function setupScrollAnimations() {
            // Animate first section content
            gsap.to("#section1 h1", {
                opacity: 1,
                y: 0,
                duration: 1,
                scrollTrigger: {
                    trigger: "#section1",
                    start: "top center",
                    end: "bottom center",
                }
            });

            gsap.to("#section1 p", {
                opacity: 1,
                y: 0,
                duration: 1,
                delay: 0.3,
                scrollTrigger: {
                    trigger: "#section1",
                    start: "top center",
                    end: "bottom center",
                }
            });

            // Section 2 - Model rotation
            if (model) {
                gsap.to(model.rotation, {
                    x: Math.PI / 4,
                    y: Math.PI * 2,
                    duration: 2,
                    scrollTrigger: {
                        trigger: "#section2",
                        start: "top bottom",
                        end: "bottom top",
                        scrub: true,
                    }
                });
            }

            gsap.to("#section2 h2, #section2 p", {
                opacity: 1,
                y: 0,
                stagger: 0.2,
                duration: 1,
                scrollTrigger: {
                    trigger: "#section2",
                    start: "top center",
                    end: "bottom center",
                }
            });

            // Section 3 - Camera movement
            gsap.to(camera.position, {
                x: 3,
                y: 2,
                z: 7,
                duration: 2,
                scrollTrigger: {
                    trigger: "#section3",
                    start: "top bottom",
                    end: "bottom top",
                    scrub: true,
                }
            });

            gsap.to(camera, {
                fov: 50,
                onUpdate: function () {
                    camera.updateProjectionMatrix();
                },
                scrollTrigger: {
                    trigger: "#section3",
                    start: "top bottom",
                    end: "bottom top",
                    scrub: true,
                }
            });

            gsap.to("#section3 h2, #section3 p", {
                opacity: 1,
                y: 0,
                stagger: 0.2,
                duration: 1,
                scrollTrigger: {
                    trigger: "#section3",
                    start: "top center",
                    end: "bottom center",
                }
            });

            // Section 4 - Material/color changes
            if (model) {
                // Apply material changes to all meshes in the model
                model.traverse(function (child) {
                    if (child.isMesh && child.material) {
                        // Store original color
                        child.material.userData = {
                            originalColor: child.material.color.clone()
                        };

                        // Animate to a purple tint
                        gsap.to(child.material.color, {
                            r: 0.5,
                            g: 0.1,
                            b: 0.8,
                            duration: 2,
                            scrollTrigger: {
                                trigger: "#section4",
                                start: "top bottom",
                                end: "center center",
                                scrub: true,
                            }
                        });
                    }
                });
            }

            gsap.to("#section4 h2, #section4 p", {
                opacity: 1,
                y: 0,
                stagger: 0.2,
                duration: 1,
                scrollTrigger: {
                    trigger: "#section4",
                    start: "top center",
                    end: "bottom center",
                }
            });

            // Section 5 - Final animation
            if (model) {
                gsap.to(model.rotation, {
                    x: 0,
                    y: Math.PI * 4,
                    z: 0,
                    duration: 2,
                    scrollTrigger: {
                        trigger: "#section5",
                        start: "top bottom",
                        end: "center center",
                        scrub: true,
                    }
                });

                gsap.to(model.scale, {
                    x: 1.5,
                    y: 1.5,
                    z: 1.5,
                    duration: 2,
                    scrollTrigger: {
                        trigger: "#section5",
                        start: "top bottom",
                        end: "center center",
                        scrub: true,
                    }
                });

                // Reset materials to original colors
                model.traverse(function (child) {
                    if (child.isMesh && child.material && child.material.userData.originalColor) {
                        gsap.to(child.material.color, {
                            r: child.material.userData.originalColor.r,
                            g: child.material.userData.originalColor.g,
                            b: child.material.userData.originalColor.b,
                            duration: 2,
                            scrollTrigger: {
                                trigger: "#section5",
                                start: "top bottom",
                                end: "center center",
                                scrub: true,
                            }
                        });
                    }
                });
            }

            gsap.to(camera.position, {
                x: 0,
                y: 0,
                z: 10,
                duration: 2,
                scrollTrigger: {
                    trigger: "#section5",
                    start: "top bottom",
                    end: "center center",
                    scrub: true,
                }
            });

            gsap.to("#section5 h2, #section5 p", {
                opacity: 1,
                y: 0,
                stagger: 0.2,
                duration: 1,
                scrollTrigger: {
                    trigger: "#section5",
                    start: "top center",
                    end: "bottom center",
                }
            });
        }

        // Initialize everything when the page loads
        window.addEventListener('load', init);
    </script>
</body>

</html>